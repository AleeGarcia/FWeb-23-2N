<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doações de Materiais de Construção</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: linear-gradient(to bottom, #e0f7fa, #f5f5f5);
        color: #333;
      }

      header {
        background: linear-gradient(to right, #054840, #00796b);
        color: #fff;
        padding: 1rem;
        text-align: center;
        position: relative;
      }

      header img {
        max-width: 80px;
        position: absolute;
        top: 10px;
        left: 10px;
        border-radius: 50%;
        border: 2px solid #fff;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
      }

      main {
        padding: 2rem;
      }

      form {
        background-color: #fff;
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 500px;
        margin: 0 auto;
      }

      .form-group {
        margin-bottom: 1rem;
      }

      label {
        font-weight: bold;
        margin-bottom: 0.5rem;
        display: block;
        color: #00796b;
      }

      input,
      select {
        width: 100%;
        padding: 0.8rem;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 1rem;
        box-sizing: border-box;
      }

      input:focus,
      select:focus {
        border-color: #00796b;
        outline: none;
      }

      button {
        width: 100%;
        padding: 0.8rem;
        background-color: #00796b;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1.1rem;
      }

      button:hover {
        background-color: #004d40;
      }

      .list-item {
        margin-bottom: 1rem;
        background-color: #e0f7fa;
        padding: 10px;
        border-radius: 4px;
        display: flex;
        justify-content: space-between;
      }

      .button-remove {
        background-color: #d32f2f;
        padding: 5px 10px;
        border-radius: 4px;
        color: white;
        cursor: pointer;
      }

      .button-remove:hover {
        background-color: #c62828;
      }

      .hidden {
        display: none;
      }

      .nota-fiscal {
        background-color: #ffffff;
        border: 2px solid #00796b;
        padding: 20px;
        margin-top: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        font-family: "Arial", sans-serif;
        color: #333;
      }

      .nota-fiscal h3 {
        margin-bottom: 10px;
        color: #00796b;
        text-align: center;
        text-transform: uppercase;
        border-bottom: 2px solid #00796b;
        padding-bottom: 10px;
      }

      .nota-fiscal p {
        margin: 5px 0;
        line-height: 1.5;
      }

      .nota-fiscal .detalhes-nota {
        margin-top: 15px;
        padding: 10px;
        background-color: #e0f7fa;
        border: 1px dashed #00796b;
        border-radius: 4px;
      }

      .nota-fiscal .assinatura {
        margin-top: 20px;
        text-align: right;
        font-style: italic;
        color: #555;
      }

      /* Responsividade */
      @media (max-width: 768px) {
        main {
          padding: 1rem;
        }

        form {
          max-width: 100%;
        }

        header {
          padding: 1rem 0;
        }
      }

      @media (max-width: 480px) {
        header img {
          max-width: 100px;
          left: 5px;
        }

        header h1 {
          font-size: 1.2rem;
        }

        button {
          font-size: 1rem;
          padding: 0.7rem;
        }

        input,
        select {
          font-size: 0.9rem;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <img src="./img/logo.png" alt="Logo do site" />
      <h1>Doações de Materiais de Construção</h1>
    </header>

    <main>
      <section id="secao-cpf">
        <h2>Valide seu CPF para continuar</h2>
        <form id="formulario-cpf">
          <label for="cpf">CPF:</label>
          <input type="text" id="cpf" placeholder="Digite seu CPF" required />
          <button type="button" id="validar-cpf">Validar CPF</button>
        </form>
        <p id="feedback-cpf"></p>
      </section>

      <label for="pesquisa-item">Pesquisar Material:</label>
      <input
        type="text"
        id="pesquisa-item"
        placeholder="Digite a letra ou nome do item"
      />

      <section id="secao-doacao" class="hidden">
        <h2>Formulário de Doação</h2>
        <form id="formulario-doacao">
          <label for="nome-item">Nome do Item:</label>
          <select id="nome-item" required>
            <option value="Tijolos">Tijolos</option>
            <option value="Cimento">Cimento</option>
            <option value="Telhas">Telhas</option>
            <option value="Areia">Areia</option>
            <option value="Blocos">Blocos</option>
            <option value="Madeira">Madeira</option>
          </select>

          <label for="quantidade-item">Quantidade:</label>
          <input type="number" id="quantidade-item" min="1" required />

          <label for="regiao">Região:</label>
          <input
            type="text"
            id="regiao"
            placeholder="Ex: São Leopoldo"
            required
          />

          <button type="submit">Doar</button>
        </form>

        <h3>Lista de Doações</h3>
        <ul id="lista-doacoes"></ul>
      </section>

      <section id="secao-retirada" class="hidden">
        <h2>Retirar Item</h2>
        <button id="voltar-para-doacao" type="button">
          Voltar para "Quero Doar"
        </button>
        <form id="formulario-retirada">
          <label for="cpf-retirada">CPF:</label>
          <input
            type="text"
            id="cpf-retirada"
            placeholder="Digite seu CPF"
            required
          />

          <label for="nome-retirada">Nome:</label>
          <input
            type="text"
            id="nome-retirada"
            placeholder="Digite seu nome"
            required
          />

          <label for="nascimento-retirada">Data de Nascimento:</label>
          <input type="date" id="nascimento-retirada" required />

          <label for="estado-retirada">Escolha o Estado:</label>
          <select id="estado-retirada">
            <option value="RS">Rio Grande do Sul</option>
            <option value="SP">São Paulo</option>
            <option value="MG">Minas Gerais</option>
            <option value="RJ">Rio de Janeiro</option>
          </select>

          <label for="sede-retirada">Escolha a Sede:</label>
          <select id="sede-retirada">
            <option value="Sede 1">Sede 1</option>
            <option value="Sede 2">Sede 2</option>
            <option value="Sede 3">Sede 3</option>
          </select>

          <button type="submit">Retirar</button>
        </form>

        <div id="nota-fiscal" class="nota-fiscal hidden">
          <h3>Nota Fiscal</h3>
          <p id="detalhes-nota"></p>
        </div>
      </section>
    </main>

    <script>
      let itensDoacao = [];

      function filtrarDoacoes() {
        const pesquisaTermo = document
          .getElementById("pesquisa-item")
          .value.toLowerCase();
        const listaDoacoes = document.getElementById("lista-doacoes");
        listaDoacoes.innerHTML = "";

        const itensFiltrados = itensDoacao.filter((item) =>
          item.nome.toLowerCase().startsWith(pesquisaTermo)
        );
        

        itensFiltrados.forEach((item, index) => {
          const itemLista = document.createElement("li");
          itemLista.textContent = `${item.nome} - ${item.quantidade} unidade(s) - Região: ${item.regiao}`;
          const botaoRetirar = document.createElement("button");
          botaoRetirar.textContent = "Retirar";
          botaoRetirar.addEventListener("click", () =>
            mostrarFormularioRetirada(index)
          );
          itemLista.appendChild(botaoRetirar);
          listaDoacoes.appendChild(itemLista);
        });
      }

      document
        .getElementById("pesquisa-item")
        .addEventListener("input", filtrarDoacoes);

      function validarCPF(cpf) {
        return /^\d{11}$/.test(cpf);
      }

      function carregarDadosCPF() {
        const cpf = localStorage.getItem("cpf");
        if (cpf) {
          document.getElementById("secao-cpf").style.display = "none";
          document.getElementById("secao-doacao").style.display = "block";
        }
      }

      document.getElementById("validar-cpf").addEventListener("click", () => {
        const cpfInput = document.getElementById("cpf").value.trim();
        const feedback = document.getElementById("feedback-cpf");

        if (!validarCPF(cpfInput)) {
          feedback.textContent = "CPF inválido. Deve ter 11 dígitos numéricos.";
          feedback.style.color = "red";
          return;
        }

        localStorage.setItem("cpf", cpfInput);
        feedback.textContent = "CPF validado com sucesso!";
        feedback.style.color = "green";

        document.getElementById("secao-cpf").style.display = "none";
        document.getElementById("secao-doacao").style.display = "block";
      });

      document
        .getElementById("formulario-doacao")
        .addEventListener("submit", (event) => {
          event.preventDefault();

          const nomeItem = document.getElementById("nome-item").value.trim();
          const quantidadeItem = document
            .getElementById("quantidade-item")
            .value.trim();
          const regiao = document.getElementById("regiao").value.trim();

          if (!nomeItem || !quantidadeItem || !regiao) {
            alert("Por favor, preencha todos os campos.");
            return;
          }

          const novoItem = {
            nome: nomeItem,
            quantidade: quantidadeItem,
            regiao: regiao,
          };
          itensDoacao.push(novoItem);
          exibirDoacoes();

          event.target.reset();
        });

      function exibirDoacoes() {
        const listaDoacoes = document.getElementById("lista-doacoes");
        listaDoacoes.innerHTML = "";
        itensDoacao.forEach((item, index) => {
          const itemLista = document.createElement("li");
          itemLista.textContent = `${item.nome} - ${item.quantidade} unidade(s) - Região: ${item.regiao}`;
          const botaoRetirar = document.createElement("button");
          botaoRetirar.textContent = "Retirar";
          botaoRetirar.addEventListener("click", () =>
            mostrarFormularioRetirada(index)
          );
          itemLista.appendChild(botaoRetirar);
          listaDoacoes.appendChild(itemLista);
        });
      }

      function mostrarFormularioRetirada(index) {
        document.getElementById("secao-doacao").style.display = "none";
        document.getElementById("secao-retirada").style.display = "block";

        document.getElementById("formulario-retirada").onsubmit = (event) => {
          event.preventDefault();

          const nomeRetirada = document
            .getElementById("nome-retirada")
            .value.trim();
          const cpfRetirada = document
            .getElementById("cpf-retirada")
            .value.trim();
          const nascimentoRetirada = document
            .getElementById("nascimento-retirada")
            .value.trim();
          const estadoRetirada =
            document.getElementById("estado-retirada").value;
          const sedeRetirada = document.getElementById("sede-retirada").value;

          document.getElementById("nota-fiscal").classList.remove("hidden");
          document.getElementById("detalhes-nota").innerHTML = `
        <p><strong>CPF:</strong> ${cpfRetirada}</p>
        <p><strong>Nome:</strong> ${nomeRetirada}</p>
        <p><strong>Data de Nascimento:</strong> ${nascimentoRetirada}</p>
        <p><strong>Estado:</strong> ${estadoRetirada}</p>
        <p><strong>Sede:</strong> ${sedeRetirada}</p>
      `;
        };
      }

      document
        .getElementById("voltar-para-doacao")
        .addEventListener("click", () => {
          document.getElementById("secao-retirada").style.display = "none";
          document.getElementById("secao-doacao").style.display = "block";
        });

      carregarDadosCPF();
    </script>
  </body>
</html>
